import streamlit as st
import pandas as pd
import numpy as np

# ===================== 1. åŸºç¡€æ•°æ®ï¼š5å®¶é¤å…æ ¸å¿ƒä¿¡æ¯ + 12ä¸ªæœˆä»·æ ¼æ•°æ® + é«˜å³°æ—¶æ®µæ•°æ® =====================
# å›ºå®š5å®¶é¤å…åŸºç¡€ä¿¡æ¯
restaurants_base = {
    "é¤å…åç§°": ["ä¸œæ–¹å¹¿åœº", "ä¸‡è¾¾å¹¿åœº", "æœé˜³å¹¿åœº", "å¥½å‹ç¼˜", "è¥¿å†·ç‰›æ’åº—"],
    "ç±»å‹": ["ä¸­é¤", "ä¸­é¤", "å¿«é¤", "è‡ªåŠ©é¤", "è¥¿é¤"],
    "è¯„åˆ†": [4.2, 4.5, 4.0, 4.7, 4.3],
    "latitude": [22.807814, 22.832476, 22.819243, 22.809105, 22.839699],
    "longitude": [108.448890, 108.286408, 108.321189, 108.378664, 108.245804]
}

# ç”Ÿæˆ12ä¸ªæœˆçš„ä»·æ ¼æ•°æ®ï¼ˆæ¨¡æ‹Ÿ5å®¶é¤å…1-12æœˆäººå‡æ¶ˆè´¹èµ°åŠ¿ï¼Œä¿è¯5æ¡æŠ˜çº¿ï¼‰
np.random.seed(123)  # å›ºå®šéšæœºæ•°ï¼Œä¿è¯æ•°æ®å¯å¤ç°
months = ["1æœˆ", "2æœˆ", "3æœˆ", "4æœˆ", "5æœˆ", "6æœˆ", "7æœˆ", "8æœˆ", "9æœˆ", "10æœˆ", "11æœˆ", "12æœˆ"]
price_data = {
    "æœˆä»½": months,
    "ä¸œæ–¹å¹¿åœº": np.random.uniform(14, 18, 12).round(1),  # 15å…ƒå·¦å³æ³¢åŠ¨
    "ä¸‡è¾¾å¹¿åœº": np.random.uniform(19, 23, 12).round(1),    # 20å…ƒå·¦å³æ³¢åŠ¨
    "æœé˜³å¹¿åœº": np.random.uniform(24, 28, 12).round(1),    # 25å…ƒå·¦å³æ³¢åŠ¨
    "å¥½å‹ç¼˜": np.random.uniform(34, 38, 12).round(1),        # 35å…ƒå·¦å³æ³¢åŠ¨
    "è¥¿å†·ç‰›æ’åº—": np.random.uniform(48, 52, 12).round(1)     # 50å…ƒå·¦å³æ³¢åŠ¨
}

# ç”Ÿæˆé«˜å³°æ—¶æ®µå®¢æµæ•°æ®ï¼ˆç”¨äºé¢ç§¯å›¾ï¼Œæ¨¡æ‹Ÿæ¯æ—¥11:00-14:00/17:00-20:00å®¢æµï¼‰
peak_hours = ["11:00", "12:00", "13:00", "14:00", "17:00", "18:00", "19:00", "20:00"]
peak_flow_data = {
    "æ—¶æ®µ": peak_hours,
    "ä¸œæ–¹å¹¿åœº": np.random.uniform(80, 120, 8).round(0),    # ä¸­é¤é«˜å³°å®¢æµ
    "ä¸‡è¾¾å¹¿åœº": np.random.uniform(90, 130, 8).round(0),    # ä¸­é¤é«˜å³°å®¢æµ
    "æœé˜³å¹¿åœº": np.random.uniform(150, 200, 8).round(0),   # å¿«é¤é«˜å³°å®¢æµï¼ˆæ›´é«˜ï¼‰
    "å¥½å‹ç¼˜": np.random.uniform(70, 100, 8).round(0),      # è‡ªåŠ©é¤é«˜å³°å®¢æµ
    "è¥¿å†·ç‰›æ’åº—": np.random.uniform(60, 90, 8).round(0)    # è¥¿é¤é«˜å³°å®¢æµ
}

# ===================== 2. æ•°æ®æ•´ç† =====================
# åŸºç¡€ä¿¡æ¯DataFrame
df_base = pd.DataFrame(restaurants_base)
df_base.index = pd.RangeIndex(start=1, stop=6, name="åºå·")  # 5å®¶åº—åºå·1-5

# 12ä¸ªæœˆä»·æ ¼èµ°åŠ¿DataFrameï¼ˆç”¨äºæŠ˜çº¿å›¾ï¼‰
df_price = pd.DataFrame(price_data)

# é«˜å³°æ—¶æ®µå®¢æµDataFrameï¼ˆç”¨äºé¢ç§¯å›¾ï¼‰
df_peak = pd.DataFrame(peak_flow_data)

# ===================== 3. é¡µé¢å±•ç¤º =====================
st.title("é¤å…æ•°æ®å¯è§†åŒ–åˆ†æ")

# 3.1 å±•ç¤º5å®¶é¤å…åŸºç¡€ä¿¡æ¯
st.header("â„¹ï¸  ä¸€ã€5å®¶é¤å…åŸºç¡€ä¿¡æ¯")
st.dataframe(df_base, use_container_width=True)

# 3.2 æ–°å¢ï¼šé¤å…è¯„åˆ†æŸ±çŠ¶å›¾
st.header("ğŸ‘ äºŒã€é¤å…è¯„åˆ†å¯¹æ¯”")
st.subheader("å„é¤å…è¯„åˆ†æŸ±çŠ¶å›¾")
st.bar_chart(
    df_base,
    x="é¤å…åç§°",
    y="è¯„åˆ†",
    color="#FF6347",  # è‡ªå®šä¹‰é¢œè‰²ï¼ˆç•ªèŒ„çº¢ï¼‰
    width=800,
    height=400,
    use_container_width=False
)

# 3.3 12ä¸ªæœˆä»·æ ¼èµ°åŠ¿æŠ˜çº¿å›¾ï¼ˆæ ¸å¿ƒè¦æ±‚ï¼š5æ¡æŠ˜çº¿ï¼‰
st.header("ğŸ’° ä¸‰ã€5å®¶é¤å…12ä¸ªæœˆäººå‡æ¶ˆè´¹èµ°åŠ¿")
st.subheader("äººå‡æ¶ˆè´¹æœˆåº¦å˜åŒ–æŠ˜çº¿å›¾")
st.line_chart(
    df_price,
    x="æœˆä»½",
    y=["ä¸œæ–¹å¹¿åœº", "ä¸‡è¾¾å¹¿åœº", "æœé˜³å¹¿åœº", "å¥½å‹ç¼˜", "è¥¿å†·ç‰›æ’åº—"],
    width=800,
    height=500,
    use_container_width=False
)

# 3.4 æ–°å¢ï¼šé«˜å³°æ—¶æ®µå®¢æµé¢ç§¯å›¾
st.header("ğŸ½ å››ã€é¤å…é«˜å³°æ—¶æ®µå®¢æµåˆ†å¸ƒ")
st.subheader("æ¯æ—¥é«˜å³°æ—¶æ®µï¼ˆ11:00-14:00/17:00-20:00ï¼‰å®¢æµé¢ç§¯å›¾")
st.area_chart(
    df_peak,
    x="æ—¶æ®µ",
    y=["ä¸œæ–¹å¹¿åœº", "ä¸‡è¾¾å¹¿åœº", "æœé˜³å¹¿åœº", "å¥½å‹ç¼˜", "è¥¿å†·ç‰›æ’åº—"],
    color=["#FF9999", "#66B2FF", "#99FF99", "#FFCC99", "#FF99CC"],  # è‡ªå®šä¹‰5æ¡é¢ç§¯å›¾é¢œè‰²
    width=800,
    height=500,
    use_container_width=False
)

# 3.5 é¤å…ä½ç½®åœ°å›¾ï¼ˆä¿ç•™åŸæœ‰åœ°ç†ä¿¡æ¯å±•ç¤ºï¼‰
st.header("ğŸ—º äº”ã€é¤å…åœ°ç†ä½ç½®åˆ†å¸ƒ")
st.map(df_base[["latitude", "longitude"]], zoom=10)
